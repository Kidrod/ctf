import  requests
from tqdm import tqdm
from base64 import b64decode, b64encode
# Define a function to perform the bit-flipping operation on a given position and bit within a base64-encoded cookie.
def bit_flip(pos, bit, data):
    raw = b64decode(b64decode(data).decode())

    list1 = bytearray(raw)
    list1[pos] = list1[pos] ^ bit
    raw = bytes(list1)
    return b64encode(b64encode(raw)).decode()

cookie = "aUMxMXhiYmpSaW5LVllKWDdPclZsUUVRTU9XZ25oSjNwZGFWY1hoYjY1Y0dJOFptWElqTTR0eGJYMjBRODluYzF1TlhhcjdzS2NxTWVNMWQ4NHhLSTB4MlBGRU1ydXY3QVplTjVRRFJPQzYyT0JKT0E0MkdkTTRPSDFVU2ZGYnQ="

#Inside the nested loops, the bit_flip() function is called to generate a modified cookie by flipping the bit at the current position and bit index.
for position_idx in tqdm(range(128)):
    for bit_idx in tqdm(range(128)):
        auth_cookie = bit_flip(position_idx, bit_idx, cookie)
        cookies = {'auth_name': auth_cookie}
        r = requests.get('http://mercury.picoctf.net:25992/', cookies=cookies)
        if "picoCTF{" in r.text:
            print(r.text)
            break
